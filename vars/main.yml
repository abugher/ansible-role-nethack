---
create_files:
  # Copying this from existing (working) files.  Reconsider later.
  - owner:              'root'
    group:              'staff'
    mode:               '2755'
    state:              'directory'
    path:               '/usr/local/src'
# I might want to set ownership of the source files to ansible and drop sudo for the build phase -- after the refactor and a good test.
install_packages:
  - 'x11-common'
  - 'sshfs'
  - 'libncurses5-dev'
  - 'byacc'
  - 'flex'
  - 'make'
  - 'gcc'
  - 'flex'
  - 'bison'
  - 'build-essential'
unpack_tarballs:
  - src:                "{{ role_path }}/files/source/nethack-362-src.tgz"
    dest:               '/usr/local/src'
    creates:            '/usr/local/src/nethack-3.6.2'
scripts:
  - script:             "{{ role_path }}/files/scripts/build_nethack_3.6.2"
    creates:            '/usr/local/src/nethack-3.6.2/src/nethack'
commands:
  - command:            'make install'
    chdir:              '/usr/local/src/nethack-3.6.2'
    creates:            '/usr/local/games/lib/nethackdir/nethack-but-just-overwrite-it'
    user:               'root'
install_files:
  - owner:              'root'
    group:              'root'
    mode:               '0755'
    src:                "{{ role_path }}/files/bin/nethack"
    dest:               '/usr/local/bin/nethack'
  - owner:              'root'
    group:              'root'
    mode:               '0755'
    src:                "{{ role_path }}/files/bin/notehack"
    dest:               '/usr/local/bin/notehack'
  - owner:              'root'
    group:              'root'
    mode:               '0755'
    src:                "{{ role_path }}/files/conf/sysconf"
    dest:               '/usr/local/games/lib/nethackdir/sysconf'
lines_in_files:
  - dest:               '/etc/fuse.conf'
    line:               'user_allow_other'
    regexp:             'user_allow_other'
  # https://nethackwiki.com/wiki/Talk:Colors
  - dest:               '/etc/X11/Xresources/x11-common'
    line:               'NetHack*VT100.cursorColor:              foreground'
    regexp:             'NetHack*VT100.cursorColor'
  - dest:               '/etc/X11/Xresources/x11-common'

    line:               'NetHack*VT100.background:               #000000 /* black */'
    regexp:             'NetHack*VT100.background'
  - dest:               '/etc/X11/Xresources/x11-common'
    line:               'NetHack*VT100.foreground:               #808080 /* CLR_GRAY */'
    regexp:             'NetHack*VT100.foreground'
  - dest:               '/etc/X11/Xresources/x11-common'
    line:               'NetHack*VT100.allowBoldFonts:           false   /* no "thick" bold characters */'
    regexp:             'NetHack*VT100.allowBoldFonts'
  - dest:               '/etc/X11/Xresources/x11-common'
    line:               'NetHack*VT100.colorBDMode:              true'
    regexp:             'NetHack*VT100.colorBDMode'
  - dest:               '/etc/X11/Xresources/x11-common'
    line:               'NetHack*VT100.colorBD:                  #BFBFBF /* lightgrey */'
    regexp:             'NetHack*VT100.colorBD'
  - dest:               '/etc/X11/Xresources/x11-common'
    line:               'NetHack*VT100.color0:                   #000000 /* background */'
    regexp:             'NetHack*VT100.color0'
  - dest:               '/etc/X11/Xresources/x11-common'
    line:               'NetHack*VT100.color1:                   #BF0000 /* CLR_RED */'
    regexp:             'NetHack*VT100.color1'
  - dest:               '/etc/X11/Xresources/x11-common'
    line:               'NetHack*VT100.color2:                   #00BF00 /* CLR_GREEN */'
    regexp:             'NetHack*VT100.color2'
  - dest:               '/etc/X11/Xresources/x11-common'
    line:               'NetHack*VT100.color3:                   #804000 /* CLR_BROWN */'
    regexp:             'NetHack*VT100.color3'
  - dest:               '/etc/X11/Xresources/x11-common'
    line:               'NetHack*VT100.color4:                   #0077ff /* CLR_BLUE */'
    regexp:             'NetHack*VT100.color4'
  - dest:               '/etc/X11/Xresources/x11-common'
    line:               'NetHack*VT100.color5:                   #BF00BF /* CLR_MAGENTA */'
    regexp:             'NetHack*VT100.color5'
  - dest:               '/etc/X11/Xresources/x11-common'
    line:               'NetHack*VT100.color6:                   #00BFBF /* CLR_CYAN */'
    regexp:             'NetHack*VT100.color6'
  - dest:               '/etc/X11/Xresources/x11-common'
    line:               'NetHack*VT100.color7:                   #BFBFBF /* not used in nethack */'
    regexp:             'NetHack*VT100.color7'
  - dest:               '/etc/X11/Xresources/x11-common'
    line:               'NetHack*VT100.color8:                   #404040 /* CLR_BLACK & NO_COLOR */'
    regexp:             'NetHack*VT100.color8'
  - dest:               '/etc/X11/Xresources/x11-common'
    line:               'NetHack*VT100.color9:                   #FF8000 /* CLR_ORANGE */'
    regexp:             'NetHack*VT100.color9'
  - dest:               '/etc/X11/Xresources/x11-common'
    line:               'NetHack*VT100.color10:                  #00FF00 /* CLR_BRIGHT_GREEN */'
    regexp:             'NetHack*VT100.color10'
  - dest:               '/etc/X11/Xresources/x11-common'
    line:               'NetHack*VT100.color11:                  #FFFF00 /* CLR_YELLOW */'
    regexp:             'NetHack*VT100.color11'
  - dest:               '/etc/X11/Xresources/x11-common'
    line:               'NetHack*VT100.color12:                  #0080FF /* CLR_BRIGHT_BLUE */'
    regexp:             'NetHack*VT100.color12'
  - dest:               '/etc/X11/Xresources/x11-common'
    line:               'NetHack*VT100.color13:                  #FF00FF /* CLR_BRIGHT_MAGENTA */'
    regexp:             'NetHack*VT100.color13'
  - dest:               '/etc/X11/Xresources/x11-common'
    line:               'NetHack*VT100.color14:                  #00FFFF /* CLR_BRIGHT_CYAN */'
    regexp:             'NetHack*VT100.color14'
  - dest:               '/etc/X11/Xresources/x11-common'
    line:               'NetHack*VT100.color15:                  #FFFFFF /* CLR_WHITE */'
    regexp:             'NetHack*VT100.color15'
known_hosts:
  - 'neuron'            # Make this a reference to a role, or hostgroup, or something.
